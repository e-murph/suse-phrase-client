= 仪表板变量
:revdate: 2025-11-24
:page-revdate: {revdate}
:description: 使用变量创建动态仪表盘

通过为仪表盘配置变量，可以创建带有动态部件的仪表盘。通过变量，可以在不同的使用情况下重复使用单个仪表盘定义。

== 查看仪表板变量
在顶部导航栏中，使用 "保存..."按钮旁边的下拉菜单，然后单击 "编辑仪表盘变量"。

image::dashboards/open-variables-drawer.png[添加所有固定项目]

=== 内置变量
{stackstate-product-name} 内置了一些变量。这些变量的名称是保留的，你不能给自己的变量取相同的名称。

要查看所有内置变量，请单击标题为 "SUSE Observability PromQL 变量 "的手拉风琴。

== 添加新变量

. 打开 "编辑仪表板变量 "抽屉。
. 点击 "添加变量 "按钮，打开第二个抽屉，在此配置新变量。

image::dashboards/variable-drawer-example.png[变量示例]

变量的配置字段如下：

|===
| 字段名称 | 说明

| 名称
| 变量的名称标识符。这是可以<<using-variables, 在兼容字段中使用的>>名称。

| 显示标签
| 变量的友好名称，在<<selecting-variables, 选择变量>>时显示在仪表板上。这有助于确定变量。

| 说明
| 说明变量的用途。该说明显示在 "编辑仪表盘变量 "抽屉中。

| 类型
| 变量的类型。
|===

== 变量类型
=== 文本变量

文本变量包含简单的文本。您可以设置初始值，并使变量成为只读变量。

=== 列表变量

列表变量的可能值由 "来源 "字段定义。每种源类型都提供了附加字段，让你缩小变量可能取值的范围。

|===
| 来源类型 | 来源领域

| 公制标签名称
| 输入零个或多个系列选择器，以细化出现的度量衡标签名称。

| 度量标签值
| 输入度量衡标签名称和零个或多个系列选择器，以细化哪些度量衡标签值存在。

| 度量衡 PromQL
| 输入自定义 PromQL 查询和标签名称。由此产生的可能值就是给定标签名称的值。

| 静态列表
| 输入一个或多个标签和值对，构建可能值的静态列表。
|===

更改源类型及其相关字段时，抽屉右侧的预览将根据新的可能值进行更新。


==== 常用列表变量设置

所有列表变量源还有以下共同设置：

|===
| 字段名称 | 说明

| 分类
| 对列表中的值进行排序。例如，按字母或数字排列。

| 允许多个值
| 允许用户一次选择多个值。

| 启用 "包含所有内容"
| 在用户看到的列表中添加一个选择所有值的项目。您可以选择为该项指定一个自定义值，或者让它自动生成。
|===

== 使用变量 [[using-variables]]
一旦定义了变量，就可以用它来填充仪表盘中的各种字段：

* 其他变量
* 小工具名称和说明
* 小工具链接字段：URL、名称和工具提示
* 小工具查询字段：PromQL 表达式、别名和最小步骤
* Markdown widget 的编辑器

要在兼容字段中使用变量，请使用用`${}` 包装的变量名（例如`$\{my_variable}` ）。对变量值进行内插。

=== 如何对变量进行插值
文本变量是以写入变量文本框中的字符串的形式进行插值的。

同样，对于不允许多值或 "包含所有内容 "的列表变量，将以列表中所选项目的值进行插值。

无论选择的是一个还是多个选项，允许多个值的列表变量都会以正则表达式捕捉所选值的组进行插值（例如`(value_1|value_2)` ）。

启用了 "包含所有内容 "选项并为该变量选择的列表变量将以插值方式显示：* 自定义值（如果已定义），或 * 生成的正则表达式，捕捉所有可能值的组群（例如`(value_1|value_2|value_3)`)

在使用插值为正则表达式捕获组的变量时，可以使用 PromQL 正则表达式匹配器`=~` 。

== 选择变量 [[selecting-variables]]
变量列在仪表盘顶部，时间范围选择器旁边。仅显示前几个变量。要查看其他变量，请使用 "更多 "下拉菜单。

单击变量打开其选择器，并选择要在仪表盘上显示的值。

当您选择不同的值时，使用该变量的 widget 将对变化做出反应。
