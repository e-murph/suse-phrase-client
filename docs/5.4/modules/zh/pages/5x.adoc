= 5.x 发布说明
:revdate: 2025-08-26
:page-revdate: {revdate}
:page-opendocs-origin: /14.releasenotes/01.5x/01.5x.md
:page-opendocs-slug:  /releasenotes/5x

== 5.x 版本发布说明

[NOTE]
====
要接收新版本的电子邮件通知，请订阅此 SUSE 邮件列表： https://lists.suse.com/mailman/listinfo/neuvector-updates
====

=== 5.4.6 2025 年 8 月

==== 新功能

* *NVSHAS-6733*：将响应规则导出为 CRD。
* *NVSHAS-9899*：NeuVector Java 服务的流程配置文件警报包含敏感数据。
* *NVSHAS-9990*：为用户密码采用新的哈希算法。
* *NVSHAS-9968*：支持设置默认管理员账户的默认密码。

==== 已修复的错误

* *NVSHAS-10062*：管理器在第一次登录时创建管理员密码失败时未显示 ERROR。
* *NVSHAS-10041*：通过 ConfigMap 配置联盟时，联盟操作因 "无效数据 "而失败。
* *NVSHAS-10018*：Neuvector 无法扫描 GitLab 注册表中的所有图像。
* *NVSHAS-10017*：与允许进程相关的假阳性安全警报。
* *NVSHAS-10001*：组删除后，"保护"/"监控 "执行仍 "存在"。
* *NVSHAS-9985*：   NeuVector（Fed Master）为所有来自外部的请求制造了麻烦。
* *NVSHAS-9981*：   每当在组中添加或更改新的 "流程配置文件规则 "时，就会触发安全事件。

==== 安全公告

* https://github.com/neuvector/neuvector/security/advisories/GHSA-8pxw-9c75-6w56[管理员账户的默认密码不安全]
* https://github.com/neuvector/neuvector/security/advisories/GHSA-8ff6-pc43-jwv3[密码管理不安全容易遭受彩虹攻击]
* https://github.com/neuvector/neuvector/security/advisories/GHSA-w54x-xfxg-4gxq[带有敏感参数的流程会导致泄密]

更多信息，请参阅xref:cve.adoc[安全公告和 CVEs]文档。

=== 5.4.5 2025 年 7 月

==== 新功能

* *NVSHAS-9776*：在舵手图中添加 etcd 容限。

==== 错误修复

* *NVSHAS-9507*：OCI 集装箱无法扫描。
* *NVSHAS-9787*：删除不必要的管理器日志。
* *NVSHAS-9788*：改进生成证书的算法。
* *NVSHAS-9789*：删除远程注册表配置中不必要的管理器日志。
* *NVSHAS-9867*：NeuVector 显示`.NET Library System.Formats.Asn1 v8.013` 受 CVE 2024-38095 影响。
* *NVSHAS-9883*：[quay.io] 通配符过滤器不适用于 Docker 注册表。
* *NVSHAS-9911*：使用 REST API 扫描软件仓库会出现不正确的 "信息"。
* *NVSHAS-9930*：`glibc/libc-bin : 2.36-9+deb12u10` 的 CVE-2018-20796 - 误报。
* *NVSHAS-9933*：注册表适配器功能（Harbor）在扫描时显示目标注册表中的错误。
* *NVSHAS-9934*：怀疑零漂移功能故障。
* *NVSHAS-9940*：NV 扫描 JFrog 子域模式问题。
* *NVSHAS-9942*：客户图像的图像扫描失败。
* *NVSHAS-9945*：如果流程名称太长，就很难确定如何创建合适的流程配置文件规则。
* *NVSHAS-9946*：显示 "凭证类型 "的 "准入控制 "警报问题。
* *NVSHAS-9947*：[UI-ext]合规性图表在 Rancher 中缺少 "手动 "状态 NeuVector.
* *NVSHAS-9948*：升级到`5.4.3` 后，NeuVector 配置丢失。
* *NVSHAS-9949*：[Harbor][不正确的用户/密码]即使输入了不正确的用户/密码，它仍能扫描图像。
* *NVSHAS-9952*：从使用报告中删除 "签名"，因为 NV 不再签发/检查许可证密钥。
* *NVSHAS-9953*：Pods Enforcer 不断重启。
* *NVSHAS-9954*：NeuVector Prometheus 输出程序生成重复的指标。
* *NVSHAS-9958*：网络规则的执行需要很长时间。
* *NVSHAS-9960*：扫描仪无法工作。
* *NVSHAS-9969*：致命错误：并发地图写入导致 Enforcer 组件重启。
* *NVSHAS-9971*：关于`Get Bootstrap Password` 的 NV UI 。
* *NVSHAS-9975*：[管理器] TypeError：`this.mousemoveListener` 不是 NV GUI 中观察到的函数。
* *NVSHAS-9986*：在 Federated 策略组视图中无法编辑或删除流程和文件访问规则。
* *NVSHAS-9988*：UI：当小组超过 2,000 个时，小组页面不会显示所有小组。
* *NVSHAS-9991*：用户界面中缺少`nv.gatekeeper-controller-manager.openshift-azure-guardrails` 组。
* *NVSHAS-9993*：用 SHA256 代替 MD5。
* *NVSHAS-9994*：执法者吊舱不断重启。
* *NVSHAS-9996*：舵图应允许执行者 pod 采用非特权模式。
* *NVSHAS-9998*：无法从 NeuVector 联合主站导出组。
* *NVSHAS-10000*：将 NV 升级到 BCI 15.7。
* *NVSHAS-10003*：当 Rancher UI 打开时，重新加载页面在独立的 NV 页面上不起作用。
* *NVSHAS-10008*：注册表扫描 - 已扫描图像的 "查看 "菜单已损坏。
* *NVSHAS-10010*：TCP SYN 泛洪会阻塞入口，导致完全阻塞入口流量。

=== 5.4.4 2025 年 5 月

==== 新功能

* **NVSHAS-9915**：在 NeuVector 用户界面中显示 Harbor 扫描仪模块的扫描结果。
* **NVSHAS-9904**：将`imagePullPolicy` 暴露于`values.yaml` 的每个组件。
* **NVSHAS-9869**：UI：将 DDoS 控制移至组窗格。
* **NVSHAS-9840**：[GCP] NeuVector 自动驾驶仪支持 GCP。
* **NVSHAS-9248**：显示带有计数器和`Last Used` 时间戳的未使用进程/网络规则。
* **NVSHAS-8160**：[控制器] 调整安全风险分数计算的某些项目。
* **NVSHAS-4673**：建议在导出组之前添加信息。

==== 错误修复

* **NVSHAS-9931**：如果多集群中的 NeuVector 产品版本不一致，则添加警告。
* **NVSHAS-9925**：`/v1/scan/asset/images` 注册表页面上的 API 失败。
* **NVSHAS-9913**：删除与工作负载：XYZ 组相关的若干网络规则时出现问题。
* **NVSHAS-9912**：更新 Helm 关于控制器服务账户所需的某些 K8s RBAC 权限。
* **NVSHAS-9909**：使用 NeuVector Rancher NavLink 时显示 "已签出 - 转到加载页面 "消息。
* **NVSHAS-9898**：在联合环境中，修改客户创建的 fed.* 组（如 fed.core-systems）的标准不起作用。
* **NVSHAS-9894**：[Enforcer]`Nv.protect` 拒绝控制器就绪探测命令`cat /tmp/ready` 。
* **NVSHAS-9886**：网络活动无法解析自定义外部组连接的域名。
* **NVSHAS-9884**：[节点扫描][容器扫描]扫描将失败。
* **NVSHAS-9873**：NeuVector 5.4.2 中的用户界面高级过滤器搜索问题。
* **NVSHAS-9865**：导出的网络策略有所不同，取决于选择的顺序（选择的组相同）。
* **NVSHAS-9828**：[Enforcer：进程] NeuVector Enforcer 无法检测短时 pod（少于 5 秒）。
* **NVSHAS-9783**：添加拒绝 icmp 数据包的网络策略后，NeuVector 在`Security Events` 中看不到任何警报。
* **NVSHAS-9176**：如果具有命名空间`rt_scan:w` 角色权限的用户登录，则在 "**安全风险">"漏洞**"页面中显示脚本错误。

=== 5.4.3 2025 年 3 月

==== 新功能

* **NVSHAS-9793**：通过 ConfigMap 和 Secret 部署 NeuVector 时，允许在 LDAP/userinitcfg 中使用 Fed 全局角色。
* **NVSHAS-9764**：[RFE] 为 Azure 添加对 "远程存储库配置 "的支持。
* **NVSHAS-9759**：在 "入侵-暴露报告 "中添加日期详情。
* **NVSHAS-9755**：要求在机密警报中显示环境变量名称和值。
* **NVSHAS-9748**：[Helm] NeuVector Helm 更新，支持 CRD 中通用组的名称引用 (NVSHAS0-4717)。
* **NVSHAS-9426**：在 Helm 图表中添加扫描仪的 hostPath。
* **NVSHAS-9326**：NeuVector - Harbor 可插拔扫描仪模块。
* **NVSHAS-9835**：用于禁用节点自动扫描的用户界面。
* **NVSHAS-7997**：ghcr.io 的扫描仪连接器。
* **NVSHAS-7982**：从联邦主控器分配 WAF 传感器。

==== 错误修复

* **NVSHAS-9849**：执法人员未在控制器上注册。
* **NVSHAS-9847**：通配符过滤器不适用于 Docker 注册表。
* **NVSHAS-9833**：Rancher 部署中配置还原失败。
* **NVSHAS-9832**：使用工作量组创建网络规则的问题。
* **NVSHAS-9821**：流程名称与流程利润规则警报的命令行不匹配。
* **NVSHAS-9817**：创建 NvClusterSecurityRule CRD 显示创建成功，但由于进程规则条目重复，实际上并未创建。
* **NVSHAS-9812**：NeuVector prometheus-exporter 指标错误。
* **NVSHAS-9811**：[管理器]在秘密上使用带有根 CA 和中间 CA 的自定义证书 (CA) 时，无法访问图形用户界面。
* **NVSHAS-9801**：FIPS 模式 +`manager.env.ssl=false` 会导致管理器出错。
* **NVSHAS-9792**：由于主体大小超过 Consul 最大值，联邦策略同步失败。
* **NVSHAS-9784**：NeuVector 在扫描 Jfrog 图像存储库时返回 404。
* **NVSHAS-9783**：添加拒绝 icmp 数据包的网络策略后，用户在 "安全事件 "中看不到任何警报。
* **NVSHAS-9780**：NeuVector 单点登录无法与 Rancher NavLink 协同工作。
* **NVSHAS-9777**：Webhook JSON 含有重复的 "级别 "键。
* **NVSHAS-9770**：零漂移模式后的自动切换会切换不正确的策略。
* **NVSHAS-9765**：在保护模式下，文件访问不会被完全阻止。
* **NVSHAS-9756**：Enforcer CPU 已达到最大值，并有多个内存压力警报。
* **NVSHAS-9668**：RKE2 合规性测试失败。
* **NVSHAS-9265**：PRE PCI 环境中不完整和不正确的漏洞扫描结果。
* **NVSHAS-9227**：注册表扫描在扫描过程中卡住，进入 "闲置 "状态。
* **NVSHAS-9729**：在一个项目中部署多个命名空间中 "同名 "的状态集时，会观察到不正确的漏洞计数。
* **NVSHAS-9810**：NeuVector 控制器无响应，用户界面无法访问。

=== 5.4.2 2025 年 1 月

==== 新功能

* **NVSHAS-9726**：监视器现在可以传递代理 URL。
* **NVSHAS-9719**：宣布内置证书退役。
* **NVSHAS-9715**：Helm 图表值支持在控制器和管理器上设置节点端口。
* **NVSHAS-9710**：在 "**漏洞**"选项卡中加入可排序的`feed_rating` 列。
* **NVSHAS-9669**：通过 REST API 进行总体安全评分。
* **NVSHAS-9590**：可为所有资产选择哪种漏洞评分。
* **NVSHAS-7555**：在 "安全事件 "下加入 "自动刷新 "选项。

==== 错误修复

* **NVSHAS-9662**：Helm 图表 2.8.2 中角色/角色绑定逻辑不一致。
* **NVSHAS-9652**：观察到 splunk 中系统日志格式的差异。
* **NVSHAS-9649**：容器链接在安全事件中产生 404 响应代码。
* **NVSHAS-9613**：NeuVector Manager Pod 错误/NeuVector Web UI 不可用。
* **NVSHAS-9507**：OCI 集装箱无法扫描。
* **NVSHAS-9443**：通过 ArgoCD 升级/安装失败，因为无法创建 leases.coordination.k8s.io 对象。
* **NVSHAS-9436**：可能是针对 CVE-2024-7347 的 CVE 假阴性。
* **NVSHAS-8386**：私钥和自签名证书仍以多种图像形式发货。
* **NVSHAS-9754**: [UI] 防止 Rancher 相关 SSO 用户禁用 OpenShift 或 Rancher 的 RBAC 验证。
* **NVSHAS-9751**：[运行时保护] 监控模式 + 零漂移在执行子进程时不会生成任何警报。
* **NVSHAS-9721**：当用户输入错误的注册表名称时，用户界面应弹出相应的错误信息。
* **NVSHAS-9696**：漏洞页面上的资产颜色指示不一致。
* **NVSHAS-9686**：Neuvector Helm 图表中注册表适配器证书的硬编码命名空间。
* **NVSHAS-9678**：更换衬垫后错误痕迹过多。
* **NVSHAS-9670**：经理sbt 运行中的纯文本响应双引号问题和 Java 未命名库问题。
* **NVSHAS-9667**：在控制器部署中将`CTRL_PATH_DEBUG` env 变量设置为错误不起作用。
* **NVSHAS-9665**：文件访问规则：删除预定义规则会产生 "setRowData "错误。
* **NVSHAS-9664**：政策组：删除自定义脚本会产生 "setRowData" 类型错误。

[NOTE]
====
管理器和注册表适配器服务的默认类型已更改为 ClusterIP。 如果首选 NodePort，用户仍然可以通过覆盖`manager.svc.type` 和`cve.adapter.svc.type` 来覆盖设置。
====

NeuVector 5.4.2 版本不再支持使用内置内部证书进行部署。NeuVector 5.4.2 容器镜像中`/etc/neuvector/certs/internal` 找到的证书将被删除。要继续使用 NeuVector，用户应

==== 5.4.2 新安装：

===== 使用舵：

- 在 Helm 图表中启用`internal.autoGenerateCert` 和`internal.autoRotateCert` 标志（从 5.4.2 版开始默认启用）。另外，YAML 方法链接如下。

===== 使用 YAML：

- xref:internal.adoc#_replacing_certificates_used_in_internal_communications_of_suse_security[使用现有方法]提供xref:internal.adoc#_replacing_certificates_used_in_internal_communications_of_suse_security[内部证书]。

==== 从以前的版本升级到 5.4.2：

请从扫描仪为控制器、执行器和注册表适配器创建和配置内部证书，以便在不丢失数据的情况下实现滚动更新。仍建议在升级前备份配置。

只有在部署使用`.yaml` 文件时，才需要以下步骤。使用 Helm 升级不需要这些额外步骤，因为默认情况下会通过以下标志创建内部证书：`internal.autoGenerateCert` 和`internal.autoRotateCert` 。

[,shell]
----
docker run -it --entrypoint=bash neuvector/scanner:3.654 -c "cat /etc/neuvector/certs/internal/ca.cert" > ca.crt
----

[,shell]
----
docker run -it --entrypoint=bash neuvector/scanner:3.654 -c "cat /etc/neuvector/certs/internal/cert.pem" > tls.crt
----

[,shell]
----
docker run -it --entrypoint=bash neuvector/scanner:3.654 -c "cat /etc/neuvector/certs/internal/cert.key" > tls.key
----

[,shell]
----
kubectl create secret generic internal-cert -n neuvector  --from-file=tls.key --from-file=tls.crt --from-file=ca.crt
----

配置了内部证书的 5.4.2 yaml 示例：*https://github.com/neuvector/manifests/blob/main/kubernetes/5.4.0/neuvector-k8s.yaml*

有关xref:internal.adoc[内部证书]的其他信息。


在 PVC 配置的情况下，用户可以在新安装中配置现有的 PVC 以恢复配置。


**扫描仪附加说明：**

对于目前使用 5.4.2 之前版本的用户，该证书将继续保留在`neuvector/scanner:latest` 中，直至 2025 年 3 月 31 日。过期将被删除。用户应计划向控制器、执行器、扫描仪和注册表适配器提供相同的内部证书，以便继续使用扫描仪。

请注意，独立扫描仪不受这些更改的影响。

=== 5.4.1 2024 年 11 月

==== 新功能

* **NVSHAS-8583**：为规则集设置细粒度的策略模式，在每个组级别分别设置网络策略模式和配置文件模式。
* **NVSHAS-9440**：在 CRD 中支持独立的网络模式和进程与文件模式。
* **NVSHAS-9369**：通过控制器的 helm 部署支持添加调试日志类别。
* **NVSHAS-9040**：改进监控模式下拒绝接受控制规则时的系统日志信息。

==== 错误修复

* **NVSHAS-9416**：[扫描仪] activemq-all-5.8.0.redhat-60024.jar 不能被任何 vul 检测到（但以前的扫描仪构建可以）。
* **NVSHAS-9447**：控制器/扫描仪 pod 崩溃 - "不支持的系统退出"。
* **NVSHAS-9278**：在最新的扫描仪镜像中发现了 CVE-2024-41110。
* **NVSHAS-9467**：由 pod 标签定义的自定义组不会在子容器上传播其配置文件数据。
* **NVSHAS-9442**：ArgoCD 上的部署问题。
* **NVSHAS-9436**：可能是针对 CVE-2024-7347 的 CVE 假阴性。
* **NVSHAS-9468**：修正 CVE-2020-26160 以 jwt:v5 取代 jwt-go。
* **NVSHAS-9517**：入场控制不一致，结果不正确。
* **NVSHAS-9532**：图像扫描已完成，但仍不允许部署。
* **NVSHAS-9558**：JWT 令牌过期报告 http.StatusRequestTimeout 408.
* **NVSHAS-9576**：当用户使用带有 Jenkins 的控制器模式进行扫描时，清除注册表数据的密码字段。
* **NVSHAS-9425**：容器有 vxlan 时创建 nfq。
* **NVSHAS-9771**：[注册表] 筛选所有扫描图像的功能不佳。
* **NVSHAS-9589**：托管群集断开连接 - 与主群集的版本不匹配。
* **NVSHAS-8824**：用户无法删除自己的组，无法创建名称空间作用域组。
* **NVSHAS-9605**：错误地允许使用无效策略模式和进程配置文件模式值的导出组。
* **NVSHAS-9608**：当控制器对巨大的扫描结果 ~23MB 报告错误时，扫描仪没有报告任何错误。
* **NVSHAS-9534**：入场控制显示错误。
* **NVSHAS-9600**：无法禁用控制器调试。
* **NVSHAS-9631**：减少执行者的一些失误。
* **NVSHAS-9645**：先前的 CRD 处理失败。
* **NVSHAS-9592**：尽管有新的数据库版本，但没有新的扫描。
* **NVSHAS-9212**：如果 neuvector-binding-secret 角色（绑定）不正确，则在 GET(/v1/eula) 中显示提示信息。
* **NVSHAS-9367**：增强注册表连接失败时的错误信息。
* **NVSHAS-9475**：折叠菜单时，背景网格打印未完全覆盖。
* **NVSHAS-9485**：用户界面中 "网络安全策略模式 "的信息不正确。
* **NVSHAS-9480**：部署在 Rancher 下游群集上的 NV UI 在 Rancher 注销后抛出 HTTP/403。
* **NVSHAS-9547**：安全风险--> 漏洞表的排序被破坏。
* **NVSHAS-9570**：[漏洞] 更改资产上不同状态的图例说明。
* **NVSHAS-9561**：仪表板的总体安全得分应与实际得分相符。
* **NVSHAS-9522**：[漏洞] 无论用户刷新或重新登录页面，过滤后的数据都会被保留。
* **NVSHAS-9597**：当控制器对 POST(v1/group) 返回 403 时，用户界面不响应任何错误。
* **NVSHAS-8682**：CRD webhook 服务需要从 CRD 舵图移至应用程序舵图。

==== 已知问题

* 在 2.8.3 图表版本中，我们将先前错误分配的资源从 crds 移到了 core。如果同时使用 crds 和 core 图表，先部署 core 图表可能会在升级过程中出现问题。要解决这个问题，请先升级 crds，然后再升级核心图表。

=== 5.4 2024 年 9 月

* **改进用户界面**
** 显示 Rancher SSO 用户。
** 管理 JWT 标记。
** 增强图像导航和扫描结果链接。
* **增强安全性**：
** 新的合规过滤器。
** 支持 CIS 基准和 OCI 图像签名。
* **网络与监控**：
** 高级带宽和会话跟踪
** DDoS 监控。
** 支持多网络。
* **证书管理**：
** 新增内部证书过期通知，包括轮换功能。
* **自动化与集成**：
** 联邦自动化。
** Rancher RBAC 集成。
** 改进准入控制。
* **性能与效率**：
** 减少内存使用量
** 降低互联网服务提供商的数据收费。
** 扫描仪缓存统计曝光。
* **改进可用性**：
** 支持 Bootstrap 密码。
** 云计费数据存档。
** 执行命名空间边界。

==== 新功能

* **NVSHAS-9012**：在 NV UI 上显示具有相同用户名的 Rancher SSO 用户。
* **NVSHAS-8939**：在 NV UI 上提供一个选项，以便 Rancher SSO 会话用户可以放弃当前的 JWT 令牌（即注销）。
* **NVSHAS-7522**：通过注册表轻松进行图像导航。
* **NVSHAS-8148**：从容器映像链接到注册表映像扫描结果。
* **NVSHAS-9258**：新增过期证书和内部证书通知。
* **NVSHAS-8915**：支持新的合规过滤器和合规报告。
* **NVSHAS-9403**：文件监控器-UI：允许用户删除预定义的文件监控规则。
* **NVSHAS-8423**：根据配置的阈值检测组级带宽、活动会话计数和会话速率违规。
* **NVSHAS-9218**：支持联邦和 CRD 组进行 DDoS 监控。
* **NVSHAS-8461**：支持云中托管 k8s 服务的 CIS 基准。
* **NVSHAS-7664**：减少注册表扫描过程中的 ISP 数据费用。
* **NVSHAS-8868**：公开扫描仪缓存统计数据。
* **NVSHAS-8676**：改进基准脚本的 NV 保护。
* **NVSHAS-9255**：自定义不带 FQDN 的图像名称的接入控制搜索注册表。
* **NVSHAS-9144**：为漏洞配置文件添加 ID，便于识别。
* **NVSHAS-7687**：支持通过 CLI 配置执行器和控制器的日志级别（debug/error/info/warn）。
* **NVSHAS-7518**：更改{product-name} 组件的内部证书。
* **NVSHAS-9287**：启用证书内旋。
* **NVSHAS-8562**：添加内部证书过期通知。
* **NVSHAS-8486**：支持 Multus 网络接口。
* **NVSHAS-7447**：Rancher RBAC 与{product-name} 的集成。
* **NVSHAS-7822**：无需调用 API 脚本即可实现联邦自动化。
* **NVSHAS-8799**：创建合规框架，用于导入合规模板。
* **NVSHAS-8773**：在初始部署时支持引导密码。
* **NVSHAS-6740**：通过在保护模式下执行学习列表，改进零漂移基线配置文件。
* **NVSHAS-8325**：为网络规则强制执行容器命名空间边界。
* **NVSHAS-8723**：归档云计费数据。
* **NVSHAS-9086**：消除 vulTrait 数据结构，减少控制器进程内存使用量。
* **NVSHAS-6979**：在警报内容中包含响应规则注释的功能。
* **NVSHAS-8845**：创建具有 FedReader 和 FedAdmin 角色的 APIKEY。
* **NVSHAS-9306**：准入控制配置评估显示负责允许或拒绝部署的规则 ID。
* **NVSHAS-9078**：支持 OCI 图像的图像签名。
* **NVSHAS-7945**：支持 Kubernetes 的 DISA STIG 基准。
* **NVSHAS-8234**：准入控制逻辑允许本应拒绝的图像。

==== 错误修复

* **NVSHAS-9005**：注册表中的类型错误：无法读取未定义的属性（读取 "total_records"）。
* **NVSHAS-9085**：资产查看 PDF 报告显示，即使存在漏洞，也只有 0% 的漏洞。
* **NVSHAS-9084**：资产查看 PDF 报告在图像列表为空时显示 NaN。
* **NVSHAS-9128**：安全事件：如果没有工作负载的命名空间值，则无法显示容器。
* **NVSHAS-9025**：Neuvector 漏洞的容器接受范围。
* **NVSHAS-9155**：注册表扫描图像列名不正确且缺少文件名
* **NVSHAS-9122**：使用 Rancher SSO 登录 "多集群 "时，Neuvector Master 会随时退出登录。
* **NVSHAS-9266**：注册表扫描：没有漏洞时，应隐藏或禁用 "按层扫描报告 "按钮。
* **NVSHAS-9219**：允许用户启用 auth 服务器的服务器证书验证。
* **NVSHAS-9246**：CSV/PDF 导出过滤不起作用。
* **NVSHAS-8947**：通过 Rancher SSO 验证时无法导入 NV 配置。
* **NVSHAS-9282**：UI：由于缺少令牌，编辑 OpenShift 注册表项失败。
* **NVSHAS-9098**：增强风险页面加载的用户体验。
* **NVSHAS-9267**：由于 REST API 的更改，不允许 5.4 主群集上的用户界面切换到 5.4 之前的托管群集。
* **NVSHAS-9285**：UI：下拉列表按钮与其他元素重叠。
* **NVSHAS-9302**：无法创建具有 FedReader 和 FedAdmin 角色的 APIKEY。
* **NVSHAS-8539**：重新配置代理设置丢失密码。
* **NVSHAS-9293**：删除漏洞报告中无关的图像细节。
* **NVSHAS-9238**：更改群集名称后，用户界面不会刷新显示的群集名称。
* **NVSHAS-9363**：通知配置 > Webhooks 网格未正确对齐。
* **NVSHAS-9362**：安全风险漏洞过滤器返回 0 个结果。
* **NVSHAS-8699**：如果 Rancher AD 用户相同，则无法区分用户。
* **NVSHAS-9062**：在 NV UI 上显示具有相同用户名（控制器上的转换）的 Rancher SSO 用户。
* **NVSHAS-9071**：某些模块仅在容器扫描中未报告。
* **NVSHAS-8242**：调用 gRPC 以测试控制器是否处理临界严重性。
* **NVSHAS-8908**：考虑到逗号分隔符，正确解析 X-Forwarded-Port。
* **NVSHAS-9024**：AdmissionControl Risky Role Perf.
* **NVSHAS-9091**：在 repo、注册表和单机扫描中，无法报告 ol:9.1、photon:5.0、rhel:9.1 和 amzn:2023 源代码下的所有模块。
* **NVSHAS-8997**：大幅减少每个节点的策略时隙数，以提高性能。
* **NVSHAS-9059**：即使从 K8s 中删除后，也能在 NV 中看到 CRD 组。
* **NVSHAS-9107**：在 rest.handlerConfigLocalCluster.Goroutine 中崩溃。
* **NVSHAS-9108**：端口 18500 不应该打开。
* **NVSHAS-9119**：Goroutine在probe.(*FileNotificationCtr).AddContainer()处崩溃。
* **NVSHAS-9125**：不允许创建设置无效的 CRD 条目。
* **NVSHAS-9124**：Docker：报告了许多意外的健康检查进程事件。
* **NVSHAS-9111**：NV 应检查`--event-qps > 0` 。
* **NVSHAS-9130**：启动特定容器后，会发现意外的 Container.Package.Updated 事件。
* **NVSHAS-9080**：Fed 阅读器用户无法访问某些 REST API。
* **NVSHAS-9092**：命名用户不应看到全局资产。
* **NVSHAS-9116**：如果连接中断，工人集群可以离开。
* **NVSHAS-8980**：在 oc 4.15 中成功获取节点上的主机和隧道接口。
* **NVSHAS-9188**：将 mgmt-br 接口设置为收割节点的主机接口。
* **NVSHAS-4858**：不在控制器中扩展容器组，以提高策略部署性能并减少 CPU 和内存使用量。
* **NVSHAS-8700**：Rancher AD 用户有时无法登录{product-name} 。
* **NVSHAS-9121**：组的网络监控阈值设置不可编辑。
* **NVSHAS-9189**：控制器关闭并重新启动后，扫描将卡在调度中。
* **NVSHAS-9019**：修复主机接口链路状态不同步的问题。
* **NVSHAS-8305**：移除内置证书。
* **NVSHAS-9013**：移除过程监控器上的 BPF 过滤器。
* **NVSHAS-7853**：TLS 握手 EOF。
* **NVSHAS-9290**：启用 ZD 后，用户添加的流程配置文件规则不生效。
* **NVSHAS-9301**：部署在 Rancher Prime 上的 NV 无法分辨出这是 Rancher 的味道。
* **NVSHAS-9289**：缺少 RBAC 时允许升级。
* **NVSHAS-7601**：改进在场景中从 PV 配置备份还原的功能。
* **NVSHAS-7687**：为 enforcer 添加系统日志级别设置。
* **NVSHAS-9292**：修复入口出口暴露显示 0 个漏洞。
* **NVSHAS-9270**：支持 CIS 基准管道的 k3s。
* **NVSHAS-9338**：警报 "托管群集 [id] 与主群集断开连接"。
* **NVSHAS-9358**：使用代理进行图像扫描会失败。
* **NVSHAS-9337**：检测到 SYN 泛洪时发送日志信息。
* **NVSHAS-9209**：从 k8s 中删除命名空间时删除域缓存。
* **NVSHAS-8985**：控制器重启后，联合注册表会消失。

==== 已知问题：

* **NVSHAS-9443**：通过 ArgoCD 升级/安装失败，因为无法创建 leases.coordination.k8s.io 对象。
* **解决方法**在使用 ARGO CD 升级到 5.4.0 之前创建给定的租约对象。如果命名空间与 neuvector 不同，则更改命名空间。
+
--
[,bash]
----
cat <<EOF | kubectl apply -f -
apiVersion: coordination.k8s.io/v1
kind: Lease
metadata:
  name: neuvector-controller
  namespace: neuvector
spec:
  leaseTransitions: 0
---
apiVersion: coordination.k8s.io/v1
kind: Lease
metadata:
  name: neuvector-cert-upgrader
  namespace: neuvector
spec:
  leaseTransitions: 0
EOF
----
--

=== 5.3.4 2024 年 7 月

==== 错误修复

* 使用 OpenShift CLI v4.15 可成功检索`host` 和`tunnel` 接口。
* 主机接口 IP 不包括 IP 范围 169.254.x.x。
* 执行器启动 1 分钟后重新检查主机接口。
* 修复了 OpenID 发行方 URL regex 失败的问题。
* 修复以下 CVE：
+
|===
| CVE | 适用于 | 影响

| CVE-2023-42364
| busybox
| {CVE-medium}

| CVE-2023-42365
| busybox
| {CVE-medium}

| CVE-2024-6197
| curl
| {CVE-medium}

| CVE-2024-6874
| curl
| {CVE-medium}

| CVE-2024-5535
| opensl
| {CVE-critical}

| CVE-2024-4741
| opensl
| {CVE-medium}
|===

=== 5.2.4-s5 2024 年 7 月

* 修复以下 CVE：

|===
| CVE | 适用于 | 影响

| CVE-2023-42363
| busybox
| {CVE-medium}

| CVE-2023-42364
| busybox
| {CVE-medium}

| CVE-2023-42365
| busybox
| {CVE-medium}

| CVE-2023-42366
| busybox
| {CVE-medium}

| CVE-2024-6197
| curl
| {CVE-medium}

| CVE-2024-6874
| curl
| {CVE-medium}

| CVE-2024-5535
| opensl
| {CVE-critical}

| CVE-2024-4603
| opensl
| {CVE-medium}

| CVE-2024-4741
| opensl
| {CVE-medium}
|===

=== 5.3.3 2024 年 6 月

==== 改进

* 允许用户从`Admission Controls` 页面阻止使用特定存储类别。
* `LDAP Authentication` 有两个分隔字段，分别用于`baseDN` 和`groupDN` 配置。
* `Egress and Ingress chart` 有一个新的漏洞列，其中包含每个服务的`High` 和`Medium` 漏洞计数。

==== 错误修复

* 修正了在多条目`Admission Control user criteria` 中使用逗号 (`,`) 时与`regex` 相关的错误。
* 修正了`jar` 软件包的 CVE 扫描无法显示受同一 CVE 影响的所有软件包的错误。现在，所有发生的情况都会报告。
* 修复以下 CVE：

|===
| CVE | 适用于 | 影响

| CVE-2024-35195
| python:requests
| {CVE-medium}

| CVE-2024-21011
| openjdk11
| {CVE-low}

| CVE-2024-21012
| openjdk11
| {CVE-low}

| CVE-2024-21068
| openjdk11
| {CVE-low}

| CVE-2024-21085
| openjdk11
| {CVE-low}

| CVE-2024-21094
| openjdk11
| {CVE-low}
|===

==== 其他

* 使用 Helm 图表安装{product-name} 时，允许用户为`updater-cron-job` 设置资源。
* 对 Prometheus 输出程序容器版本管理进行审查，并将其与`controller` 版本管理分离。
* (扫描仪）检测 Ubuntu 和 Red Hat Enterprise Linux 中的`R` 软件包/模块。
* (扫描仪）已添加对 PHP Composer 扫描的支持。

=== 5.2.4-s3 April 2024

* 修复以下 CVE：

|===
| CVE | 适用于 | 影响

| CVE-2021-40633
| giflib
| {CVE-high}

| CVE-2023-48161
| giflib
| {CVE-high}

| CVE-2024-28757
| 侨民
| {CVE-high}

| CVE-2023-39742
| giflib
| {CVE-medium}

| CVE-2023-45288
| go:golang.org/x/net
| {CVE-medium}

| CVE-2024-25629
| c-ares
| {CVE-medium}

| CVE-2024-3651
| python:idna
| {CVE-medium}

| CVE-2024-2511
| opensl
| {CVE-low}
|===

=== 5.3.2 April 2024

==== 错误修复

* 从以前的{product-name} 版本升级到 v5.3.1 后，可能会无意中删除已有的 NvClusterSecurityRule 自定义资源。注意：为了避免升级问题，5.3.1 版本已从 docker hub 中删除。

=== 5.3.1 April 2024

[IMPORTANT]
====
为了防止 5.3.2 中修复的升级问题，5.3.1 版本已从 docker hub 中删除。请使用 5.3.2 版本。
====

==== 改进

* 允许用户在使用 Github 操作时定义'`accepted`' 漏洞，使其不会影响工作流程。
* 在 "资产">"注册表">"图像漏洞 "视图中添加严重性、得分级别和反馈评级筛选器。
* 在配置注册表时，允许注册表使用已定义的代理进行注册表镜像扫描。

==== 错误修复

* 安全风险 > 漏洞 > 高级过滤器无法过滤 "无修复的 CVE
* 从容器到主机模式容器的意外违规行为
* 切换到 docker api 1.24 时接受 OCI 图像格式
* 注册表扫描不应扫描非图像工件/不记录错误
* 允许无根密钥对图像签名验证，无需依赖互联网或 sigstore。
* 特定节点的网络规则不允许发生安全事件（与 "容器任务已满 "错误信息有关）
* 容器无法成功添加到工作负载（经常出现）。通道信息造成的死锁。

==== 其他

* 更新 Jenkins、GitHub action 和 Bamboo 的扫描仪插件。
* (扫描仪）切换到 docker api 1.24 时，接受 OCI 图像格式。
* (扫描仪）"注册表扫描 "不应扫描非图像工件/不记录错误。
* (扫描器）增加对 php composer 扫描的支持。

==== {product-name} 用户界面扩展 v.1.0 for Rancher 2024 年 3 月

* 安装{product-name} 后，xref:rancher.adoc#_suse_security_ui_extension_for_rancher[启用/安装]Rancher 的{product-name} UI 扩展将显示群集的控制面板，包括到{product-name} 完整群集的 SSO 链接。注意：扩展可能显示为 "第三方"，这将在未来的版本中修复。此外，安装后，Rancher 2.7.x 用户可能会在列表中看到两个{product-name} UI Ext 图标（错误）。一个图标会显示 "卸载"（表示已安装），另一个图标则显示 "安装"。这可以保持不变，即如果扩展已安装，则不要再次安装。

=== 5.2.4-s2 2024 年 2 月

* 修复以下 CVE：
* 高 cve：expat 中的 CVE-2023-52425、openjdk11 中的 CVE-2024-20952 和 CVE-2024-20918
* Med cve：expat 中的 CVE-2023-52426，openjdk11 中的 CVE-2024-20926、CVE-2024-20921、CVE-2024-20945 和 CVE-2024-20919，openssl 中的 CVE-2024-0727 和 CVE-2023-6237

=== 5.3.0 2024 年 2 月

==== 改进

* 在仪表板（出口）、PDF 和 CSV 报告以及网络活动屏幕和安全事件（违规）列表中显示外部目标 URL（FQDN）
* 在 "发现 "模式下，自动学习外部 FQDN 地址组的出口。除非外部连接符合现有规则，否则将创建一个新的外部 FQDN 自定义组。
* 通过新的控制器环境变量 CTRL_EN_ICMP_POLICY = 1 启用 ICMP 学习（发现模式）和阻止（保护模式
* 将 CRD 导出到 Github，以支持使用控制台或 REST API 将 gitops 导出到默认仓库。
* 通过 ADFS iDP 支持 SAML SSO 单次注销
* 增加对 ARM64 平台的支持。从基于 ARM 的平台调用时，将自动调用相应的 ARM64{product-name} 映像。
* 通过代理支持网络钩子
* 改进准入控制审核功能，使其包括所有规则的结果。列出每条规则的结果，并为在实时准入控制部署中进行评估时的最终操作添加另一个条目。
* 通过 CRD 或 yaml (kubectl) 应用禁用的准入控制规则
* 通过控制台、CRD 或 REST API 导出/导入漏洞配置文件。导入将替换现有配置文件。删除 CRD 将导致配置文件为空。
* 通过控制台、CRD 或 REST API 导出/导入合规性配置文件模板。导入将替换现有模板。
* 在合规报告中为必须由用户手动运行的 CIS 基准添加 "手动 "状态（不能由{product-name} 运行）。
* 改进 "漏洞 "页面的用户界面加载/性能
* 统一浏览器会话登录。有了它，浏览器中的所有标签页都能共享同一个登录会话，从现有会话打开新标签页时不会要求输入凭据，而且当一个标签页注销时，所有标签页都会注销。
* 增强控制台（用户界面）的安全性：1) 添加强制安全标头（X-Content-Type-Options nosniff; X-XSS-Protection 1; mode=block; X-Frame-Options SAMEORIGIN; Cache-Control private, no-cache, no-store, must-revalidate HTTP Strict Transport Security max-age=15724800，2) 添加 CSP 标头（例如设置'`default-src`' 指令），3) 删除服务器名称披露
* 支持新版本的 CIS 基准。Kubernetes (1.8.0)、Kubernetes V1.24 (1.0.0)、Kubernetes V1.23 (1.0.1)、RedHat OpenShift 容器平台 (1.4.0)
* 在 Assets-> Containers-> Container 中显示注册表与运行时扫描的容器详情
* 在安全风险-> 漏洞-> 影响弹出窗口中添加组链接，以便轻松编辑组模式
* 支持通过 URL 深度链接到图像和/或容器漏洞页面
* 在控制台设置中添加密码重置选项，供管理员重置用户密码-> 用户
* 在设置-> 配置-> 通知中允许向控制器 pod 日志发送事件日志。发送的事件将以 "notification="开头，并只保存在领导者控制器 pod 中。请注意，该版本中存在一个错误，即要更改事件级别，必须启用 SYSLOG（如果需要，可在更改级别后禁用）。
* 删除对控制器/执行器挂载"/host/cgroup "的要求。
* 添加 "获取支持 "菜单，其中包含指向 slack、文档和其他资源的链接
* 将信息字段填入 /v1/log/activity 日志

==== 错误修复

* 安全风险中的内部服务器错误-> 具有大量 CVE 的漏洞
* SIGSEGV：控制器上的分段违规
* 删除易受攻击的文件（如 jar）不会从漏洞列表中移除
* 使用 SHA256withECDSA 签名算法的 Syslog 证书无效
* {product-name} 显示网络规则应允许的安全事件
* 运行 "僵尸 "执行器的非托管节点
* 高级筛选器显示补救和影响字段为空白
* 修复字符串处理，防止意外重启 Enforcer
* 与内置群组有关的意外违规行为
* 支持捆绑执行器调试 RPC 调用数据返回错误
* 组在安全事件中不匹配
* 将事件发送到 slack 无法正常工作 - 使用代理
* 显示允许网络规则的安全事件

==== 其他

* 在 Helm 图表中添加运行时容器引擎（套接字）自动检测功能
* 删除 Helm 图表中以特权模式运行控制器的设置，以及控制器/执行器挂载"/host/cgroup "的要求。
* 已从{product-name} 文档中删除 kubernetes 部署示例文件。有关示例，请参阅链接。

==== 手动部署时可能需要更改的突出显示更改（所有更改均已反映在 5.3.x 的最新 Helm 图表中）

* 自动检测容器运行时（套接字），无需指定容器运行时和套接字路径。
* 取消了在特权模式下运行控制器的要求，不再需要挂载运行时插座和挂载/host/cgroup/\...
* 在 yaml 中为 neuvector-binding-secret 和 neuvector-secret 添加了角色/角色绑定。
* 5.3 需要新的服务帐户和角色绑定
* 现在，所有引用的部署 yaml 文件路径中都包含 /5.3.0/

=== 5.2.4-s1 2024 年 1 月

==== 安全补丁发布

* 修正 openssl 中的 CVE-2023-6129 以及 curl 中的 CVE-2023-46219 和 CVE-2023-46218。

=== 5.2.4 2023 年 11 月

==== 错误修复

* Azure AKS 验证 WebhookConfiguration 更改和错误日志。

=== 5.2.3 2023 年 11 月

==== 改进

* 在扫描仪中添加对 NVD API 2.0 的支持。
* 在扫描仪独立模式下扫描容器主机。

[,shell]
----
docker run --rm --privileged --pid=host neuvector/scanner -n
----

==== 错误修复

* 由于 docker cp / grpc 死锁问题，节点上的扫描失败。

=== 5.2.2-s1 2023 年 10 月

==== 安全更新

* 更新软件包以修复 CVE，包括高 CVE-2023-38545 和 CVE-2023-43804。

=== 5.2.2 2023 年 10 月

==== 针对 CVE-2023-32188 的安全公告

* 通过在部署和升级时自动生成用于签署 JWT 令牌的证书，以及在基于 Helm 的部署期间自动生成管理器/RESTful API 证书，补救 CVE-2023-32188"`JWT token compromise can allow malicious actions including Remote Code Execution (RCE)`" 。
 ** 用于 JWT 签名的证书由控制器自动创建，有效期为 90 天，并自动轮换。
 ** 管理器、REST API 和注册表适配器证书的自动生成要求使用{product-name} helm 2.6.3 或更高版本进行基于 Helm 的安装。
 ** 如果在部署过程中没有更换，基于 yaml 的部署仍会使用内置证书；不过，建议更换这些证书（见下一行）。
 ** 对于以前的版本或基于 yaml 的部署，仍支持并建议手动xref:replacecert.adoc[更换证书]。有关说明，请参见{product-name} GitHub 安全公告https://github.com/neuvector/neuvector/security/advisories/GHSA-622h-h2p8-743x[。]
 ** 在基于 Helm 和 yaml 的部署中，仍像以前一样支持使用用户提供的证书。
* 为自定义合规脚本添加额外控制。默认情况下，现在不允许添加自定义脚本，除非在 Controller 和 Enforcer 中添加环境变量 CUSTOM_CHECK_CONTROL。值为 "禁用"（默认，不允许）、"严格"（仅限管理员角色）或 "宽松"（管理员、合规和运行时策略角色）。
* 防止 LDAP 注入 - 用户名字段已转义。

==== 改进

* 为 SYSLOG 发送的分层扫描 CVE 结果添加附加扫描数据
* 支持 NVD API 2.0 以扫描 CVE 数据库
* 在 Assets-> Container 详细信息中提供容器映像构建日期
* 调整网络规则的排序：在 "网络规则 "视图中禁用排序，但在 "组 "视图中启用网络规则排序。
* 使用环境变量 Enforcer THRT_SSL_TLS_1DOT0、THRT_SSL_TLS_1DOT1，启用/禁用 TLS 1.0 和 TLS 1.1 检测/警报。默认已禁用。
* 为 Controller 和 Enforcer 添加环境变量 AUTO_PROFILE_COLLECT，以帮助在调查内存压力事件时捕获内存使用情况。设置值 = 1 为启用。
* 针对 "准入控制 "的配置评估应通过一次扫描显示所有违规情况。
* 在 "响应规则 "中为 CVE 报告标准添加更多选项。例 1 - "cve-high-with-fix:X "的意思是：当（已修复的高危漏洞）数量 >= X 时，触发响应规则。例 2\--"cve-high-with-fix:X/Y "表示：当（Y 天前报告并已修复的高危漏洞）数量 >= X 时，触发响应规则。

==== 错误修复

* 导出组策略不会返回任何实际 YAML 内容
* 利用专用功能改进命名空间的剪枝工作
* {product-name} 命名空间用户无法查看资产-->命名空间
* 如果 CR 的命名空间已被删除，则跳过处理 CRD CREATE/UPDATE 请求
* 为名称空间删除后无法成功修剪的部分 CRD 组提供变通方法。

=== 5.2.1 2023 年 8 月

==== 改进

* 在 SYSLOG 信息中报告分层扫描结果和其他 CVE 数据。可通过设置-> 配置-> SYSLOG 中的复选框启用。
* 在导出的 csv 合规性报告中导出 NIST 800-53 映射（至 docker CIS 基准
* 支持图像签名验证中的代理设置
* 在下载的 CVE 报告中包含图像签名扫描结果
* 通过 "自定义标准 "为 "准入控制策略 "提供 pod 注释支持
* 在漏洞报告打印的筛选器中添加最后修改字段，并在漏洞视图中添加高级筛选器

==== 错误修复

* 在 AWS 计费（CSP 适配器）产品的初始{product-name} 部署中，不创建带有默认密码的默认管理员，要求用户使用秘密创建管理员用户名和密码
* 修复 .json 文件增大并导致 kubernetes 节点崩溃的问题
* 改进 SQL 注入检测逻辑
* 在安装{product-name} 核心图表之前先安装 helm crd 图表时，服务帐户会丢失
* 图像扫描 I.4.1 合规结果不正确
* 漏洞高级过滤器报告显示来自所有其他命名空间的图像

=== 5.2.0 2023 年 7 月

==== 改进

* 支持{product-name} API 访问令牌。请参阅设置-> 用户，API 密钥... 创建新的 API 密钥。密钥可设置为默认角色或自定义角色。
* 支持 AWS Marketplace PAYG 计费，{product-name} 每月支持订阅。用户可以订阅 SUSE 支持的{product-name} ，每月根据前一个月的平均节点数使用情况向 AWS 账户计费。详情https://open-docs.neuvector.com/deploying/awsmarketplace[] 。
* 支持图像签名以进行准入控制。用户可以通过与 Sigstore/Cosign 的集成，要求{product-name} 在将图像部署到生产环境之前，验证图像是否已由特定方签名。有关创建新签名资产，请参阅资产-> Sigstore 校验器。然后，可根据标准图像签名和/或图像 Sigstore 校验器创建规则。
* 启用每个准入控制规则的监控或保护模式。监控模式下的 "拒绝 "操作将发出警报，而保护模式下的 "拒绝 "操作将进行阻止。允许操作不受影响。
* 在 "策略">"准入控制">"为用户和用户组添加规则 "中添加新的 regex 操作符，以支持 regex。支持操作符 "匹配 ANY regex "和 "匹配 NONE regex"。
* 增加对资源限制等准入控制标准的支持。新增了资源限制标准，并通过自定义标准设置支持其他标准。
* 支持通过https://github.com/goharbor/pluggable-scanner-spec[可插拔]扫描仪接口从港湾注册表调用{product-name} 。这需要配置与控制器的连接（公开的 API）。Harbor 适配器调用控制器端点来触发扫描，控制器端点可在推送时自动扫描。审讯服务可用于定期扫描。联邦主控制器的扫描结果会传播到远程群集。 注意：基于 HTTPS 的适配器端点错误问题：请忽略 "测试连接 "错误，即使显示错误（跳过证书验证）也能正常工作。
* 用于 CVE 查询的可搜索 SaaS 服务。搜索最新的{product-name} CVE 数据库，查看数据库中是否存在特定的 CVE。{product-name} Prime（付费支持订阅）客户可使用此服务。通过您的 SCC 门户联系支持人员以获取访问权限。
* 允许用户禁用网络保护，但保持 WAF/DLP 的功能。在设置-> 配置中配置网络策略启用。
* 根据每个{product-name} 组件的需要，使用权限较低的服务账户。引入了一个变量"`leastPrivilege`" 。默认为假。注意：在 5.2.0 之前的版本中使用当前舵图和此变量将无法正常工作。
* 绑定到非默认服务帐户，以满足 CIS 1.5 5.1.5 建议。
* 启用管理员在设置-> 用户、API 密钥和角色中配置用户默认会话超时。
* 可定制的登录横幅和可定制的用户界面标题文本，适用于监管和政府部署。配置要求可xref:customui.adoc[在此处]找到。
* SYSLOG 支持 TLS 加密传输。在设置-> 配置 SYSLOG 中选择 TCP/TLS。
* 启用从 Rancher Manager 部署{product-name} 监控舵图。
* 删除注册表扫描 URL 验证器中顶级域的上限。
* 扫描 golang 依赖项，包括运行时扫描。
* 支持 Debian 12 (Bookworm) 漏洞扫描。
* 为注册表/详细信息添加 CSV 导出，以便在 Assets-> Registries 中为选定注册表导出配置注册表中所有图像的 CVE。
* 允许{product-name} 在 x.509 证书字段中并行设置多个 ADFS 证书。
* 添加并显示回复规则的注释字段。
* 通过环境变量指定{product-name} 认为是系统容器的内容。例如，对于 Rancher 和默认命名空间：NV_SYSTEM_GROUPS=*cattle-system;default
* 添加对 Kubernetes 1.27 和 OpenShift 4.12 的支持

==== 错误修复

* 减少执行者/控制者日志中的重复日志。
* 多个群集页面无法呈现。
* 空组自动删除需要 2 小时，而不是计划中的 1 小时。
* 手动允许的网络规则未应用，导致暂停图像违规。
* 即使网络规则在某些初始条件下允许流量，也会阻止 SSL 连接。
* 由于同步中的策略更新问题，即使在允许的网络规则下也会出现安全事件警告。
* 网络活动错误地将自定义组流量与外部流量关联。
* 每个 pod 中挂载的命名空间的默认服务帐户令牌权限过高。
* 尽管定义了网络规则，但当容器因内存不足（OOM）错误而停止时，安全事件下仍会记录违规行为（误报）。
* 允许用户禁用/启用对集群中未托管容器的检测和保护。可通过管理器 CLI 设置：

[,shell]
----
set system detect_unmanaged_wl status -h
Usage: cli set system detect_unmanaged_wl status [OPTIONS] {true|false}

  Enable/disable detect unmanaged container
----

==== 其他

* 在 Helm 图表中添加 "lessPrivilege "设置。为 New_Service_Profile_Baseline 添加 helm 选项。为 5.2 发布了新的 Helm 图表（核心）版本。
* 在 Helm 图表中启用 AWS Marketplace（计费适配器）集成设置。
* 更新配置图以支持新功能（多个 ADFS 证书、零漂移、New_Service_Profile_Baseline、SYSLOG TLS、用户超时）
* 将支持的 Kubernetes 版本更新到 1.19 以上，以及 OpenShift 4.6 以上（1.19 以上，带 CRI-O）

=== 5.1.3 2023 年 5 月

==== 改进

* 添加用于扫描 Microsoft .NET 框架的新漏洞源。
* Prometheus 输出程序默认禁用 Enforcer 统计，以提高可扩展性。
* 提高可用性：使用扫描仪扫描单个图像并打印结果（见下文示例）。
* 在准入控制规则标准中添加 imagePullPolicy 检查。
* 当 CRD 模式过时时显示警告信息。

==== 错误修复

* 网络活动 "屏幕不显示或不正确显示。
* 空组自动删除需要 2 小时，而不是计划中的 1 小时。
* 合规配置文件不显示在用户界面控制台中。
* 安全事件中的高级过滤器缺少 "错误 "级别。
* 带有特殊字符的已保存密码在以后的身份验证尝试中失效。
* 当请求较多时，多个群集页面无法正常呈现。
* 注册表详细信息（底部）窗格未更新。

==== 扫描仪样本输出

[,shell]
----
Image: https://registry.hub.docker.comlibrary/alpine:3.4
Base OS: alpine:3.4.6
TOTAL: 6, HIGH: 1, MEDIUM: 5, LOW: 0, UNKNOWN: 0
┌─────────┬───────────────┬──────────┬───────────┬───────────────┬────────────┐
│ PACKAGE │ VULNERABILITY │ SEVERITY │ VERSION   │ FIXED VERSION │ PUBLISHED  │
├─────────┼───────────────┼──────────┼───────────┼───────────────┼────────────┤
│ openssl │ CVE-2018-0732 │ High     │ 1.0.2n-r0 │ 1.0.2o-r1     │ 2018-06-12 │
│         ├───────────────┼──────────┤           ├───────────────┼────────────┤
│         │ CVE-2018-0733 │ Medium   │           │ 1.0.2o-r0     │ 2018-03-27 │
│         ├───────────────┤          │           ├───────────────┼────────────┤
│         │ CVE-2018-0734 │          │           │ 1.0.2q-r0     │ 2018-10-30 │
│         ├───────────────┤          │           ├───────────────┼────────────┤
│         │ CVE-2018-0737 │          │           │ 1.0.2o-r2     │ 2018-04-16 │
│         ├───────────────┤          │           ├───────────────┼────────────┤
│         │ CVE-2018-0739 │          │           │ 1.0.2o-r0     │ 2018-03-27 │
│         ├───────────────┤          │           ├───────────────┼────────────┤
│         │ CVE-2018-5407 │          │           │ 1.0.2q-r0     │ 2018-11-15 │
└─────────┴───────────────┴──────────┴───────────┴───────────────┴────────────┘
----

=== 5.1.2 2023 年 3 月

==== 改进

* 支持基于虚拟主机的地址组和策略匹配网络保护。这样就可以实现两个不同的 FQDN 地址解析到同一 IP 地址，但每个 FQDN 应执行不同规则的使用情况。可以使用'`vh:`' 指标创建一个带有'`address=vh:xxx.yyy`' 的新自定义组来启用这种保护。然后，网络规则就可以根据虚拟主机名（而不是解析的 IP 地址）将自定义组作为'`From`' 源，对虚拟主机执行不同的规则。
* 合规容器列表，以排除已退出的容器。
* 增强 DLP 规则，使其支持模式中的简单通配符。
* 添加对 cri-o 1.26+ 和 OpenShift 4.11+ 的支持。
* 让 gravatar 成为可选项。
* 在控制台/用户界面中显示群集命名空间资源。
* 在控制台中显示源严重性/分类（如 Red Hat、Ubuntu... ）以及 NVD 严重性评分。
* 如果用户通过 SSO 身份验证，则不允许禁用 Rancher 和 OpenShift 的 SSO/RBAC。
* 在 configMap 中添加自动扫描功能和删除未使用的组老化功能。
* 在 csv/pdf 中包含外部来源/目的地的 IP 地址，以防违反隐式拒绝规定
* 对控制器和执行器的 CPU 和内存使用情况进行了各种性能和可扩展性优化。

==== 错误修复

* 修复 GKE 容器优化操作系统 (COS) 节点上的应用程序在保护模式下运行缓慢的问题。
* SUSE Linux (SLES) 15.4 CVE 在扫描仪中不匹配。有了这个修复，如果在反馈中提供了严重性，即使缺少 NVD 记录，漏洞也会被添加到数据库中。报告中可能包含没有 CVE 分数的漏洞。

==== 其他

* 增强 helm 中的接入控制 CRD 选项 https://github.com/neuvector/neuvector-helm/pull/237.
* 在 helm chart 中添加新的 enforcer 环境变量。

=== 5.1.1 2023 年 2 月

==== 改进

* 将"`package`" 作为信息添加到检测到的漏洞的 syslog-event 中。
* 添加 Enforcer 环境变量 ENF_NETPOLICY_PULL_INTERVAL - 以秒为单位的值（推荐值 60），以减少 Enforcer 因策略更新/重新计算而产生的网络流量和资源消耗。(注：在 2023 年 8 月之前，这是一个未记录的新增内容）。

[,yaml]
----
           - name: ENF_NETPOLICY_PULL_INTERVAL
             value: "60"   <== regulate the pulling gap by 60 seconds
----

==== 错误修复

* 空组删除错误 "未找到对象"
* 同一容器内的流量警报/阻塞
* 使用允许规则的 istio 出口流量出现意外隐式违规行为
* 从{product-name} 4.x 版本升级时，不正确的 pod 组成员资格会导致意外的策略违规行为
* 当请求中出现额外编码字符时，ADFS 的 OIDC 身份验证失败
* dp 创建和删除 pod 时占用大量内存
* 更新 alpine 以修复多个 CVE，包括 Manager：CVE-2022-37454、CVE-2022-42919、CVE-2022-45061、CVE-2021-46848；执行者：CVE-2022-43551, CVE-2022-43552
* 修复了各种用户界面错误

==== 其他

* 更新舵手图，以便更换内部通信证书

=== 5.1.0 2022 年 12 月

==== 改进

* 集中式多集群扫描 (CVE) 数据库。主（主）群集可扫描指定为联合注册表的注册表/repo。这些注册表的扫描结果将同步到所有受管（远程）群集。这样就能在托管群集控制台中显示扫描结果，并在托管群集的准入控制规则中使用扫描结果。注册表只需扫描一次，而不是每个集群扫描一次，从而减少了 CPU/内存和网络带宽的使用。
* 加强准入控制规则：
 ** 接纳控制规则的自定义标准。允许用户在所有 pod 相关字段上定义资源标准，并在规则中使用，例如 item.metadata.annotationsKey 包含 "neuvector"，item.metadata.name='xyzzy'等。
 ** 添加标准，以便在部署 pod 时检查服务账户的高风险 RBAC 设置。这些标准包括 "对工作负载资源的任何操作"、"对 RBAC 的任何操作"、"创建工作负载资源"、"列出机密 "和 "执行到容器中"。
 ** 为接纳控制规则模块添加语义版本比较功能。这样，规则中的版本号就可以使用 > 或 < 运算符（例如，不允许部署 curl<6.2.0 模块）。这样就可以对已安装的软件包进行特定的版本检查。
 ** 为 Kubernetes 1.25 以上版本支持的 Pod 安全接纳 (PSA) 添加接纳控制规则。
* 添加新的环境变量 NO_DEFAULT_ADMIN，启用后不会创建 "admin "用户。默认用于 Rancher SSO 集成。如果未启用，则会持续警告用户并记录事件，以便在默认管理员密码未更改的情况下更改默认密码。
* 现在，登录失败后阻止登录已成为默认设置。默认值为 5 次尝试，可在设置-> 用户和角色-> 密码配置文件中配置。
* 新增用于性能调整的环境变量 ENF_NO_SYSTEM_PROFILES，值为："1".启用后，它将禁用进程和文件监控器。不会执行学习进程、配置文件模式、进程/文件（包）事件以及文件活动监控。这将减少 CPU/内存资源的使用和文件操作。
* 为扫描仪 pod 添加自定义自动缩放设置，值为延迟、立即和禁用。重要：使用 OpenShift 操作员部署扫描仪时，不支持扫描仪自动缩放，因为操作员总是会将 pod 数量更改为其配置值。
 ** *_延迟战略：_*
  *** 当导线控制器在大于 90 秒的时间内连续看到 "任务计数 "大于 0 时，如果尚未达到 maxScannerPods，则会启动一个新的扫描仪 pod
  *** 当先导控制器在大于 180 秒的时间内连续看到 "任务计数 "为 0 时，如果尚未达到 minScannerPods，则会缩减一个扫描仪 pod
 ** *_近期战略：_*
  *** 每次当主控制器看到 "任务计数">0 时，如果尚未达到 maxScannerPods，就会启动一个新的扫描仪 pod
  *** 当先导控制器在大于 180 秒的时间内连续看到 "任务计数 "为 0 时，如果尚未达到 minScannerPods，则会缩减一个扫描仪 pod
* 自定义组现在可以使用命名空间标签，包括 Rancher 的命名空间标签。一般来说，现在可以在自定义组中添加 pod 和命名空间标签。
* 在网络活动视图中增加隐藏选定命名空间和组的功能。
* 完全支持 Cilium cni。
* 完全支持 OpenShift 4.9 和 4.10。
* {product-name}/Open Zero Trust (OZT) 项目的构建工具现在可在以下网址获取 https://github.com/openzerotrust/openzerotrust.io.
* {product-name} 中列出控制器、管理器和执行器的版本 ID 和 SHA256 摘要。 https://github.com/neuvector/manifests/tree/main/versions.
* 现在，匿名遥测数据（节点数、组数、规则数）会在部署时报告给 Rancher 云服务，以帮助项目团队了解使用行为。可通过用户界面、configMap（No_Telemetry_Report）或 REST API 禁用（退出）该功能。
* (2023 年 1 月增补）。通过 Istio 支持基于 ServiceEntry 的网络策略。在 5.1.0 版中，针对使用 Istio 声明的 pod 至 ServiceEntry 目的地添加了出口网络策略执行功能。通常，ServiceEntry 会定义如何将 DNS 名称引用的外部服务解析为目标 IP。在 v5.1 版之前，{product-name} 无法检测和执行连接到 ServiceEntry 的规则，因此所有连接都被归类为外部连接。使用 5.1 版，可以针对特定的服务条目目的地执行规则。重要的是如果升级到 v5.1，并采用基于 Istio 的部署，则必须创建新规则以允许这些连接并避免违规警报。升级后，如果不存在允许规则，新的可见流量将报告隐式违规。在 "发现 "模式下，可以学习和自动创建新的交通规则。要允许这些流量，可以将组设置为发现模式，或创建一个带有地址（或 DNS 名称）的自定义组，并为该目标创建新的网络规则，以允许这些流量。注意：5.1.0 中存在一个错误，即拒绝违规报告的目的地不代表正确的目的地。 错误报告的服务器名和客户端名都是一样的。 这个问题将在即将发布的补丁中得到解决。

==== 错误修复

* 减少滚动更新时创建的不必要 cis 基准数据对控制器内存的消耗。新部署不会出现此问题。
* 从配置屏幕中删除许可证（不再需要）。

=== 5.0.6-s1 2023 年 3 月

==== 错误修复

* 更新 alpine 软件包以修复 curl 中的 CVE，包括 CVE-2023-23914、CVE-2023-23915 和 CVE-2023-23916

=== 5.0.6 2023 年 2 月

==== 错误修复

* dpMsgConnection 内存使用率过高
* 如果有很多已学习的策略规则和未管理的工作量（内存泄漏），执行器中 dp 进程的内存使用率会很高
* 嗅探容器上的流量时，tcpdump 无法成功启动
* 更新 alpine 以修复多个 CVE，包括 Manager：CVE-2022-37454、CVE-2022-42919、CVE-2022-45061、CVE-2021-46848；执行者：CVE-2022-43551, CVE-2022-43552

=== 5.0.5 2022 年 11 月

==== 错误修复

* 升级到 5.0.x 会出现关于管理器、控制器和执行器运行不同版本的错误信息。
* 执法人员遭遇例行恐慌，导致被 dp 击毙。 WebUI 未将执行器显示为联机。
* 在 coreos 上哪个命令的 NV.Protect 组中出现异常 Process.Profile.Violation 事件。

=== 5.0.4 2022 年 10 月

==== 安全更新

* 更新 alpine 以移除管理器 expat 库中的关键 CVE-2022-40674 以及其他次要 CVE。

==== 改进

* 添加对 Antrea CNI 的支持

==== 错误修复

* 修复 NV.Protect 组中的意外 process.profile.violation 事件。
* 当管理器用户界面访问禁用 SSL 时，用户密码将打印到管理器日志中。

=== 5.0.3 2022 年 9 月

==== 改进

* 从持久卷成功重启后不显示 EULA。
* 使用漏洞配置文件设置中的图像过滤器跳过容器扫描结果。
* 在 GitHub 行动中支持扫描仪，网址为 https://github.com/neuvector/neuvector-image-scan-action.
* 添加 Enforcer 环境变量，用于禁用机密扫描和运行 CIS 基准

[,yaml]
----
    env:
      - name: ENF_NO_SECRET_SCANS  (available after v4.4.4)
        value: "1"
      - name: ENF_NO_AUTO_BENCHMARK (after v5.0.3)
        value: "1"
----

==== 错误修复

* 执法者偶尔无法启动。
* 多集群联盟环境中的连接泄漏。
* 安全风险-> 合规性中的合规性页面有时无法加载

=== 5.0.2 2022 年 7 月

==== 改进

* 支持 Rancher 加固集群和 SELinux 集群。

==== 错误修复

* K3s 系统上代理进程的 CPU 占用率高。
* AD LDAP 组在升级到 5.0 后无法正常工作。
* 由于错误=打开的文件过多（rke2/cilium），执行器不断重启。
* 支持日志无法成功下载。

=== 5.0.1 2022 年 6 月

==== 改进

* 支持 openSUSE Leap 操作系统的漏洞扫描（在扫描仪图像中）。
* 扫描仪：在重建镜像 repo 时执行擦除属性。
* 验证{product-name} 部署和对启用 SELinux 的主机的支持。有关更新舵机图前临时补丁的详细信息，请参阅下文。
* + 改进 Rancher 舵图中 nginx 的入口注释。添加/更新 ingress.kubernetes.io/protocol: https 至 nginx.ingress.kubernetes.io/backend-protocol："HTTPS"。
* 当前的 OpenShift Operator 支持为 api 和联盟服务提供直通路由。添加了额外的 Helm 值参数，以支持边缘和重新加密路由终止类型。

==== 错误修复

* AKS 集群可能会在接纳控制 webhook 中添加意外密钥。
* Enforcer 无法在使用 1.64 containerd 运行时的 k8s 1.24 集群上运行。另外，执行器有时无法启动。
* 任何具有管理员角色的用户（本地用户或 SSO）在将群集升级为联接主控时，都应自动升级为联接管理员角色。
* 当 sso 使用 Rancher 默认管理员进入主集群上的{product-name} 时，{product-name} 登录角色是 admin，而不是 fedAdmin。
* 修复多个程序崩溃问题
* 来自与节点无关的主机 IP 的隐式违规。
* ComplianceProfile 未显示 PCI 标记。
* 有时不显示 LDAP 组映射。
* 风险审查和改进工具将显示错误信息 "更新系统配置失败：请求格式错误"。
* OKD 3.11 - 即使存在也会显示 Clusterrole 错误。

==== CVE 修复

* 在所有图像中的 ncurses 软件包上发现高 CVE-2022-29458 cve。
* 在 Updater 映像中的 curl 软件包上发现高 CVE-2022-27778 和 CVE-2022-27782。

==== SELinux 支持详情

{product-name} 无需任何额外设置，启用 SELinux 的集群就能部署和运行。测试了在基于 RHEL 8.5 的启用 SELinux 的 RKE2 加固集群上部署{product-name} 的情况。如果启用了 PSP 并部署了修补管理器和扫描仪，则可成功部署{product-name} 。下一个图表版本应该会修复以下问题。

附上了从 Rancher 图表启用 psp 的示例，下面给出了为管理器和扫描仪部署打补丁的命令。补丁命令中的用户 ID 可以是任何数字。

[,shell]
----
kubectl patch deploy -ncattle-neuvector-system neuvector-scanner-pod --patch '{"spec":{"template":{"spec":{"securityContext":{"runAsUser": 5400}}}}}'
kubectl patch deploy -ncattle-neuvector-system neuvector-manager-pod --patch '{"spec":{"template":{"spec":{"securityContext":{"runAsUser": 5400}}}}}'
----

启用 PSP 的示例：

[,shell]
----
[neuvector@localhost nv]$ getenforce
Enforcing
[neuvector@localhost nv]$ sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     actual (secure)
Max kernel policy version:      33

[neuvector@localhost nv]$ kk get psp
Warning: policy/v1beta1 PodSecurityPolicy is deprecated in v1.21+, unavailable in v1.25+
NAME                      PRIV    CAPS                                      SELINUX    RUNASUSER          FSGROUP     SUPGROUP    READONLYROOTFS   VOLUMES
global-restricted-psp     false                                             RunAsAny   MustRunAsNonRoot   MustRunAs   MustRunAs   false            configMap,emptyDir,projected,secret,downwardAPI,persistentVolumeClaim
neuvector-binding-psp     true    SYS_ADMIN,NET_ADMIN,SYS_PTRACE,IPC_LOCK   RunAsAny   RunAsAny           RunAsAny    RunAsAny    false            *
system-unrestricted-psp   true    *                                         RunAsAny   RunAsAny           RunAsAny    RunAsAny    false            *
[neuvector@localhost nv]$ nvpo.sh
NAME                                        READY   STATUS    RESTARTS   AGE     IP           NODE                    NOMINATED NODE   READINESS GATES
neuvector-controller-pod-54f69f7f9c-6h822   1/1     Running   0          5m51s   10.42.0.29   localhost.localdomain   <none>           <none>
neuvector-enforcer-pod-jz77b                1/1     Running   0          5m51s   10.42.0.30   localhost.localdomain   <none>           <none>
neuvector-manager-pod-588488bb78-p6vf9      1/1     Running   0          111s    10.42.0.32   localhost.localdomain   <none>           <none>
neuvector-scanner-pod-87474dcff-s8vgt       1/1     Running   0          114s    10.42.0.31   localhost.localdomain   <none>           <none>
----

=== 5.0.0 通用版本 (GA) 2022 年 5 月发布

==== 改进

* 自动推广小组模式。根据已用时间和标准提升组的保护模式。不适用于 CRD 创建的组。该功能允许新应用程序在 "发现 "模式下运行一段时间，学习其行为，并在{product-name} 上创建网络和进程的允许列表规则，然后自动转入 "监控 "和 "保护 "模式。发现监控标准：学习小组中至少一个实时 pod 的所有网络和流程活动所需的时间。监测保护标准：在为专家组设定的时间范围内，没有发生任何安全事件（网络、流程等）。
* 支持 Rancher 2.6.5 应用程序和市场图表。部署到 cattle-neuvector-system 命名空间，实现从 Rancher 到{product-name} 的 SSO。请注意：必须完全删除 Rancher 以前的部署（例如 1.9.x 及以前版本的合作伙伴目录图表），才能更新到新图表。
* 支持扫描 SUSE Linux（SLE、SLES）和 Microsoft Mariner
* 零漂移进程和文件保护这是进程和文件保护的新默认模式。零漂移只自动允许源于原始容器映像中父进程的进程，不允许安装文件更新或新文件。在 "发现 "或 "监控 "模式下，zero-drift 会对任何可疑进程或文件活动发出警报。在保护模式下，它会阻止此类活动。零漂移不需要学习进程或将其添加到允许列表中。禁用某个组的零漂移会导致该组列出的进程和文件规则生效。
* 针对网络、进程/文件的分策略模式保护。现在，设置-> 配置中提供了一个全局设置，可单独设置网络保护模式以执行网络规则。启用此功能（默认为禁用）会使所有网络规则处于所选的保护模式（发现、监控、保护），而进程/文件规则仍处于该组的保护模式，显示在策略-> 组屏幕中。这样，网络规则可以设置为 "保护"（阻止），而进程/文件策略可以设置为 "监控"，反之亦然。
* WAF 规则检测、增强型 DLP 规则（报头、URL、完整数据包）。用于网络应用程序 pod 的入口连接以及 api 服务的出口连接，以确保 api 安全。
* 用于 WAF、DLP 和准入控制的 CRD。注意：需要额外的群集角色绑定/权限。请参阅 Kubernetes 和 OpenShift 部署章节。通过 CRD 支持准入控制的 CRD 导入/导出和版本控制。
* Rancher SSO 集成可通过 Rancher Manager 启动{product-name} 控制台。只有通过 Rancher 部署{product-name} 容器时，才能使用此功能。该部署从镜像 Rancher 资源库（例如 rancher/mirrored-neuvector-controller:5.0.0）中提取，并部署到 cattle-neuvector-system 命名空间中。注意：要求更新 Rancher 2.6.5 版本 2022 年 5 月或更高版本，目前仅支持管理员和群集所有者角色。
* 支持在 RKE2 上部署。
* 通过代理支持群集联盟（多群集管理器）。在设置-> 配置中配置代理，并在配置联盟连接时启用代理。
* 监控所需的 rbac 集群角色/绑定，如有任何缺失，在事件和用户界面中发出警报。
* 在准入控制规则中支持资源限制标准。
* 支持 Microsoft Teams 格式的网络钩子。
* 支持映射角色组下的 AD/LDAP 嵌套组。
* 在 IDP for Openshift 中支持带有组信息的集群绑定或角色绑定。
* 允许将网络规则和准入控制规则提升为联邦规则。

==== 错误修复

* 修复工人联盟角色备份应还原到非联盟集群的问题。
* 改善安全风险-> 漏洞中大量 CVE 的页面加载时间
* 允许用户在策略-> 组菜单中选择所有组时切换模式。如果也选择了节点组，则发出警告。
* 折叠同名的合规检查项目并使其可展开。
* 增强 gRPC 通信的安全性。
* 修正：无法在 rke2 设置中获取正确的工作负载权限信息。
* 修复支持 openSUSE Leap 15.3 (k8s/crio) 的问题。

==== 其他更新

* 将 Helm 图表的应用程序版本更新为 5.0.0，图表版本更新为 2.2.0
* 删除了无服务器扫描功能/菜单。
* 删除了对 Jfrog Xray 扫描结果集成的支持（仍支持 Artifactory 注册表扫描）。
* 不再支持在 ECS 上部署。Allinone 应该仍能在 ECS 上部署，但不再支持有关步骤和设置的文档。

=== 从{product-name} 4.x 升级到 5.x（5.2.x 之前）

[NOTE]
====
以下说明适用于 5.0.x 和 5.1.x 的升级。对于 5.2.x，服务帐户和绑定已发生变化，应进行xref:kubernetes.adoc#_deploy_suse_security[审查]以计划升级。
====


Helm 用户请更新至{product-name} Helm chart 2.0.0 或更高版本。如果更新 OpenShift 上的 Operator 或 Helm 安装，请参阅下面的说明。

. 删除旧的 neuvector-binding-customresourcedefinition 集群角色

[,shell]
----
kubectl delete clusterrole neuvector-binding-customresourcedefinition
----

. 为 neuvector-binding-customrescedefinition clusterrole 应用新的更新动词

[,shell]
----
kubectl create clusterrole neuvector-binding-customresourcedefinition --verb=watch,create,get,update --resource=customresourcedefinitions
----

. 删除 Kubernetes 1.19+ 的旧 crd 模式

[,shell]
----
kubectl delete -f https://raw.githubusercontent.com/neuvector/manifests/main/kubernetes/crd-k8s-1.19.yaml
----

. 为 Kubernetes 1.19+ 创建新的 crd 模式

[,shell]
----
kubectl apply -f https://raw.githubusercontent.com/neuvector/manifests/main/kubernetes/5.0.0/crd-k8s-1.19.yaml
kubectl apply -f https://raw.githubusercontent.com/neuvector/manifests/main/kubernetes/5.0.0/waf-crd-k8s-1.19.yaml
kubectl apply -f https://raw.githubusercontent.com/neuvector/manifests/main/kubernetes/5.0.0/dlp-crd-k8s-1.19.yaml
kubectl apply -f https://raw.githubusercontent.com/neuvector/manifests/main/kubernetes/5.0.0/admission-crd-k8s-1.19.yaml
----

. 创建新的 Admission、DLP 和 WAF 群集角色和群集绑定

[,shell]
----
kubectl create clusterrole neuvector-binding-nvwafsecurityrules --verb=list,delete --resource=nvwafsecurityrules
kubectl create clusterrolebinding neuvector-binding-nvwafsecurityrules --clusterrole=neuvector-binding-nvwafsecurityrules --serviceaccount=neuvector:default
kubectl create clusterrole neuvector-binding-nvadmissioncontrolsecurityrules --verb=list,delete --resource=nvadmissioncontrolsecurityrules
kubectl create clusterrolebinding neuvector-binding-nvadmissioncontrolsecurityrules --clusterrole=neuvector-binding-nvadmissioncontrolsecurityrules --serviceaccount=neuvector:default
kubectl create clusterrole neuvector-binding-nvdlpsecurityrules --verb=list,delete --resource=nvdlpsecurityrules
kubectl create clusterrolebinding neuvector-binding-nvdlpsecurityrules --clusterrole=neuvector-binding-nvdlpsecurityrules --serviceaccount=neuvector:default
----

. 更新从 Docker hub (docker.io) 提取{product-name} 镜像的名称和路径，例如

* neuvector/manager:5.0.0
* neuvector/controller:5.0.0
* neuvector/enforcer:5.0.0
* neuvector/scanner:latest
* neuvector/updater:latest

可选择删除 Helm 图表、部署 yaml、配置图、脚本等中对{product-name} 许可证和注册表密文的任何引用，因为提取映像或开始使用{product-name} 不再需要这些内容。

*关于 SCC 和通过操作员/Helm 升级的说明*

在新部署中，1.3.4 及以上版本的操作员会将特权 SCC 添加到部署 yaml 中指定的服务帐户中。如果要将{product-name} Operator 从以前的版本升级到 1.3.4 或将 Helm 升级到 2.0.0，请在升级前删除特权 SCC。

[,shell]
----
oc delete rolebinding -n neuvector system:openshift:scc:privileged
----

==== 2022 年 4 月发布 Beta 1 版本

* 功能完善，包括组模式的自动推广。根据已用时间和标准提升组的保护模式。不适用于 CRD 创建的组。该功能允许新应用程序在 "发现 "模式下运行一段时间，学习其行为，并在{product-name} 上创建网络和进程的允许列表规则，然后自动转入 "监控 "和 "保护 "模式。发现监控标准：学习小组中至少一个实时 pod 的所有网络和流程活动所需的时间。监测保护标准：在为专家组设定的时间范围内，没有发生任何安全事件（网络、流程等）。
* 支持 Rancher 2.6.5 应用程序和市场图表。部署到 cattle-neuvector-system 命名空间，实现从 Rancher 到{product-name} 的 SSO。请注意：必须完全删除 Rancher 以前的部署（例如 1.9.x 及以前版本的合作伙伴目录图表），才能更新到新图表。
* 执行者、管理者、控制者的标签：5.0.0-b1 （例如，neuvector/controller:5.0.0-b1）

==== 2022 年 3 月发布预览版 3

[CAUTION]
.重要
====

要更新以前的预览部署以使用新的 CRD WAF、DLP 和准入控制功能，请更新 CRD yaml 并添加新的 rbac/role 绑定：

[,shell]
----
kubectl apply -f https://raw.githubusercontent.com/neuvector/manifests/main/kubernetes/latest/crd-k8s-1.19.yaml
kubectl create clusterrole neuvector-binding-nvwafsecurityrules --verb=list,delete --resource=nvwafsecurityrules
kubectl create clusterrolebinding neuvector-binding-nvwafsecurityrules --clusterrole=neuvector-binding-nvwafsecurityrules --serviceaccount=neuvector:default
kubectl create clusterrole neuvector-binding-nvadmissioncontrolsecurityrules --verb=list,delete --resource=nvadmissioncontrolsecurityrules
kubectl create clusterrolebinding neuvector-binding-nvadmissioncontrolsecurityrules --clusterrole=neuvector-binding-nvadmissioncontrolsecurityrules --serviceaccount=neuvector:default
kubectl create clusterrole neuvector-binding-nvdlpsecurityrules --verb=list,delete --resource=nvdlpsecurityrules
kubectl create clusterrolebinding neuvector-binding-nvdlpsecurityrules --clusterrole=neuvector-binding-nvdlpsecurityrules --serviceaccount=neuvector:default
----
====


==== 改进

* 支持扫描 SUSE Linux（SLE、SLES）和 Microsoft Mariner
* 零漂移进程和文件保护这是进程和文件保护的新默认模式。零漂移只自动允许源于原始容器映像中父进程的进程，不允许安装文件更新或新文件。在 "发现 "或 "监控 "模式下，zero-drift 会对任何可疑进程或文件活动发出警报。在保护模式下，它会阻止此类活动。零漂移不需要学习进程或将其添加到允许列表中。禁用某个组的零漂移会导致该组列出的进程和文件规则生效。
* 针对网络、进程/文件的分策略模式保护。现在，设置-> 配置中提供了一个全局设置，可单独设置网络保护模式以执行网络规则。启用此功能（默认为禁用）会使所有网络规则处于所选的保护模式（发现、监控、保护），而进程/文件规则仍处于该组的保护模式，显示在策略-> 组屏幕中。这样，网络规则可以设置为 "保护"（阻止），而进程/文件策略可以设置为 "监控"，反之亦然。
* WAF 规则检测、增强型 DLP 规则（报头、URL、完整数据包）
* 用于 WAF、DLP 和准入控制的 CRD。注意：需要额外的群集角色绑定/权限。请参阅 Kubernetes 和 OpenShift 部署章节。通过 CRD 支持准入控制的 CRD 导入/导出和版本控制。
* Rancher SSO 集成可通过 Rancher Manager 启动{product-name} 控制台。只有通过 Rancher 部署{product-name} 容器时，才能使用此功能。注意：需要更新 Rancher 版本（日期/版本待定）。
* 支持在 RKE2 上部署。
* 通过代理支持群集联盟（多群集管理器）。
* 监控所需的 rbac 集群角色/绑定，如有任何缺失，在事件和用户界面中发出警报。
* 在准入控制规则中支持资源限制标准。

==== 错误修复

* 修复工人联盟角色备份应还原到非联盟集群的问题。

==== 2022 年 2 月发布预览版 2

* 对源代码中的文件和许可证进行了少量修改，未添加任何功能。

==== 支持在 AWS ECS 上部署 已弃用

不再支持在 ECS 上部署。Allinone 应该仍能在 ECS 上部署，但不再支持有关步骤和设置的文档。

=== 5.0 "技术预览" 2022 年 1 月

==== 改进

* 首次发布不受支持的{product-name} 5.0 开放源代码 "技术预览 "版本。
* 添加对 OWASP Top-10 和 WAF 类规则的支持，以检测标题或正文中的网络攻击。包括对 CRD 签名定义的支持和对适当组的应用。
* 移除无服务器扫描功能。

==== 错误修复

* TBD

==== 其他

* Helm 图表 v1.8.9 已发布，用于 5.0.0 部署。如果在 5.0.0 预览版中使用该功能，则需对 values.yml 进行以下更改：
 ** 更新注册表到 docker.io
 ** 将图像名称/标签更新为 Docker hub 上的预览版本
 ** 将 imagePullSecrets 留空
